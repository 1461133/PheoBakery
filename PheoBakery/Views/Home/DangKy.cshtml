<?php
	session_start();
?>

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title> Sign Up</title>
    <style type="text/css">
        .style1 {
            font-family: "Courier New", Courier, monospace;
            font-weight: bold;
        }

        .style2 {
            color: #FF3333;
        }
    </style>
</head>
<body bgcolor="#000000">
    <form action="" method="POST" name="DKUser" id="DKUser" onSubmit="return KiemTra()">
        <table width="100%" border="0" align="center" bgcolor="#F0F0F0" style="margin-top:7%">
            <tr bgcolor="#333333">
                <td colspan="2" bgcolor="#00FFCC" class="tieudedky">
                    <div align="center" class="style2" style="font-weight: bold; font-family: &quot;Courier New&quot;, Courier, monospace; font-size: 36px">.:ÄÄ‚NG KÃ THÃ€NH VIÃŠN:. </div>
                </td>
            </tr>
            <tr>
                <td width="49%">
                    <div align="right" style="font-weight: bold; font-family: &quot;Courier New&quot;, Courier, monospace">TÃªn Ä‘Äƒng nháº­p: </div>
                </td>
                <td width="51%">
                    <input name="textTenDN" type="text" id="textTenDN" size="20">
                    <input name="hd1" type="hidden" value="*" style="border:#FFFFFF; color:#FF0000">
                </td>
            </tr>
            <tr>
                <td><div align="right" style=" font-weight bold;font-family &quot;Courier New&quot;, Courier, monospace">Máº­t kháº©u: </div></td>
                <td>
                    <input name="textMatkhau" type="password" id="textMatkhau" size="15">

                    <input name="hd" type="hidden" value="*" style="border:#FFFFFF; color:#FF0000">
                </td>
            </tr>
            
            <tr>
                <td><div align="right" style="font-weight bold;font-family &quot;Courier New&quot;, Courier, monospace">Nháº­p láº¡i máº­t kháº©u: </div></td>
                <td>
                    <input name="textMatkhaugolai" type="password" id="textMatkhaugolai" size="15">
                    <input name="hd2" type="hidden" value="*" style="border:#FFFFFF; color:#FF0000">
                </td>
            </tr>
            <hr color="#666666" size="2px">
            <tr>
                <td width="49%"><div align="right" style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold">Há» vÃ  tÃªn: </div></td>
                <td width="51%">
                    <input name="textHoTen" type="text" id="textHoTen">
                    <input name="hd4" type="hidden" value="*" style="border:#FFFFFF; color:#FF0000">
                </td>
            </tr>
            <tr>
                <td width="49%"><div align="right" style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold">Email: </div></td>
                <td width="51%">
                    <input name="textEmail" type="text" id="textEmail">
                    <input name="hd5" type="hidden" value="*" style="border:#FFFFFF; color:#FF0000">
                </td>
            </tr>
            
                       
            <tr>
                <td>
                    <div align="right"><span class="style1">Nháº­p kÃ½ tá»±:</span> </div>
                </td>
                <td>
                    <input type="text" name="captcha_nhap" />
                    <img src="captcha.php" title="captcha" alt="captcha" onClick="this.src='captcha.php?' + Math.random();" />
                    <span style="font-family: &quot;Courier New&quot;, Courier, monospace">
                        <input name="hd8" type="hidden" style="border:#FFFFFF; color:#FF0000; size:5px" value="*">
                    </span>
                </td>
            </tr>
            <tr>
                <td width="49%">
                    <div align="right">
                        <input name="btDangky" type="submit" id="btDangky" value="ÄÄƒng kÃ½" style="width:150px">
                    </div>
                </td>
                <td width="51%">
                    <input name="btXoa" type="reset" id="btXoa" value="XÃ³a" style="width:150px">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div align="center">
                        <input name="btBack" type="button" id="btBack" value="Há»§y Ä‘Äƒng kÃ½" style="width:200px" onClick="window.location.href='../index.php'" />
                    </div>
                </td>
            </tr>
        </table>
    </form>

</body>
</html>
<?php
	require '../configs/config.php';
	require '../libraries/connect.php';
	require '../models/user.php';
	if( isset($_POST['captcha_nhap']) && $_POST['captcha_nhap'] == $_SESSION['captcha'])
	{
		$data = array(
				'username' => $_POST['textTenDN'],
				'password' => md5($_POST['textMatkhau']),
				'fullname' => $_POST['textHoTen'],
				'email' => $_POST['textEmail'],
				'status' =>  1 ,
				'created' => date('Y-m-d H:i:s'),
				'id_group' => 0 );
		if(AddUser($data))
		{
			$id = GetUserID();
			$_SESSION['user_id'] = $id;
			?>
<p align="center" style="color:#00FFFF">
    <?php echo ("Báº¡n Ä‘Ã£ Ä‘Äƒng kÃ½ thÃ nh cÃ´ng!!!");?>
</p>
<p style="color:#00FFFF"> <a href="../index.php"> Quay vá» trang chá»§...</a></p>
<p style="color:#00FFFF" align="right"> <a href="login.php"> Chuyá»ƒn Ä‘áº¿n trang Ä‘Äƒng nháº­p...</a></p>
			<?php

		}
	}
?>
<script>
function KiemTra()
{
	myFrmObj = document.DKUser;
	if(myFrmObj.textTenDN.value == "")
	{
		window.alert("TÃªn Ä‘Äƒng kÃ½ khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng!!!");
		myFrmObj.textTenDN.focus();
		myFrmObj.hd1.type = 'label';
		return false;
	}
	else
	{
		if(myFrmObj.textMatkhau.value == "")
		{
			window.alert("Máº­t kháº©u khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng!!!");
			myFrmObj.textMatkhau.focus();
			myFrmObj.hd.type = 'label';
			return false;
		}
		else //kt mat khau toi thieu 5 ky tu
		{
			if(myFrmObj.textMatkhau.value.length <5 )
			{
				window.alert("Máº­t kháº©u pháº£i tá»‘i thiá»ƒu 5 kÃ½ tá»±!!");
				myFrmObj.textMatkhau.focus();
				myFrmObj.hd.type = 'label';
				return false;
			}
			else
			{
				if(myFrmObj.textMatkhau.value != myFrmObj.textMatkhaugolai.value)
				{
					window.alert("Máº­t kháº©u khÃ´ng trÃ¹ng nhau!!");
					myFrmObj.textMatkhaugolai.focus();
					myFrmObj.hd2.type = 'label';
					return false;
				}
				else
				{
					if(myFrmObj.textHoTen.value== "")
					{
						window.alert("Há» vÃ  tÃªn khÃ´ng thá»ƒ bá» trá»‘ng!!");
						myFrmObj.textHoTen.focus();
						myFrmObj.hd4.type = 'label';
						return false;
					}
					else
					{
						if(myFrmObj.textEmail.value== "")
						{
							window.alert("Email khÃ´ng thá»ƒ bá» trá»‘ng!!");
							myFrmObj.textEmail.focus();
							myFrmObj.hd5.type = 'label';
							return false;
						}
						else
						{
							if(myFrmObj.textNSinh.value== "")
							{
								window.alert("NgÃ y sinh khÃ´ng thá»ƒ bá» trá»‘ng!!");
								myFrmObj.textNSinh.focus();
								myFrmObj.hd6.type = 'label';
								return false;
							}
							else
							{
								if(myFrmObj.textNSinh.value >31 || myFrmObj.textNSinh.value <1)
								{
									window.alert("NgÃ y sinh khÃ´ng há»£p lá»‡!!");
									myFrmObj.textNSinh.focus();
									myFrmObj.hd6.type = 'label';
									return false;
								}
								else
								{
									if(myFrmObj.textNamSinh.value== "")
									{
										window.alert("NÄƒm sinh khÃ´ng thá»ƒ bá» trá»‘ng!!");
										myFrmObj.textNamSinh.focus();

										myFrmObj.hd7.type = 'label';
										return false;
									}
									else
									{

										if(myFrmObj.captcha_nhap.value=="" )
										{

											window.alert("kÃ½ tá»± khÃ´ng thá»ƒ bá» trá»‘ng!!");
											myFrmObj.captcha_nhap.focus();
											myFrmObj.hd8.type = 'label';
											return false;
										}
										else
										{
											return true;
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}
</script>